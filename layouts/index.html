{{ define "main" }}
<div style="text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, #f5f2ed 0%, #e5ddd3 100%); border-radius: 8px;">
  <h1 style="border: none; color: #5a4a3a; margin: 0;">{{ .Title }}</h1>
  <p style="font-size: 1.1rem; color: #7d6c5a; margin-top: 1rem;">{{ .Content }}</p>
</div>

<div class="content-section">
  <h2>ğŸ“œ Random Records</h2>
  <p style="font-style: italic; color: #7d6c5a;">Glimpses into the village's past... ({{ len (where site.RegularPages "Section" "records") }} records total)</p>
  <ul id="records-list" style="list-style: none; margin-left: 0;">
    {{ range (where site.RegularPages "Section" "records") }}
      {{ if ne .Params.record_type "announcement" }}
      <li style="display: none; padding: 0.75rem; margin-bottom: 0.5rem; background: #f9f7f4; border-left: 3px solid #8b7355; border-radius: 4px;">
        <a href="{{ .RelPermalink }}" style="border: none; font-weight: bold;">{{ .Title }}</a>
        {{ with .Date }}<span class="date"> â€“ {{ .Format "2 January 2006" }}</span>{{ end }}
        {{ with .Params.dateAdded }}<span style="font-size: 0.85rem; color: #999; margin-left: 0.5rem;">(Added {{ . }})</span>{{ end }}
      </li>
      {{ end }}
    {{ end }}
  </ul>
  <p style="text-align: right; margin-top: 1rem;"><a href="/records/">View all records â†’</a></p>
</div>

<div class="content-section">
  <h2>ğŸ“Š Census Records</h2>
  <p style="font-style: italic; color: #7d6c5a;">Browse census records by year.</p>
  <p style="text-align: right; margin-top: 1rem;"><a href="/census/">View census records â†’</a></p>
</div>

<hr>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin: 2rem 0;">
  
  <div class="content-section">
    <h2>ğŸ›ï¸ Buildings</h2>
    <ul id="buildings-list">
      {{ range (where site.RegularPages "Section" "building") }}
        {{ if .Title }}
          <li style="display: none;"><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
        {{ end }}
      {{ end }}
    </ul>
    <p style="text-align: right; margin-top: 1rem;"><a href="/building/">View all buildings â†’</a></p>
  </div>

  <div class="content-section">
    <h2>ğŸ¢ Institutions</h2>
    <ul id="institutions-list">
      {{ range (where site.RegularPages "Section" "institution") }}
        {{ if .Title }}
          <li style="display: none;"><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
        {{ end }}
      {{ end }}
    </ul>
    <p style="text-align: right; margin-top: 1rem;"><a href="/institution/">View all institutions â†’</a></p>
  </div>

  <div class="content-section">
    <h2>ğŸ‘¤ Residents</h2>
    <ul id="residents-list">
      {{ range (where site.RegularPages "Section" "resident") }}
        {{ if .Title }}
          <li style="display: none;"><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
        {{ end }}
      {{ end }}
    </ul>
    <p style="text-align: right; margin-top: 1rem;"><a href="/resident/">View all residents â†’</a></p>
  </div>
  
</div>

<script>
// Shuffle and show random items from list
function showRandomItems(listId, count) {
  const ul = document.getElementById(listId);
  if (!ul) return;
  
  const items = Array.from(ul.children);
  
  // Fisher-Yates shuffle
  for (let i = items.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [items[i], items[j]] = [items[j], items[i]];
  }
  
  // Clear the list
  ul.innerHTML = '';
  
  // Show first 'count' items from shuffled array
  const itemsToShow = items.slice(0, Math.min(count, items.length));
  itemsToShow.forEach(item => {
    item.style.display = '';
    ul.appendChild(item);
  });
}

// Show random items on page load
document.addEventListener('DOMContentLoaded', function() {
  showRandomItems('records-list', 10);
  showRandomItems('buildings-list', 8);
  showRandomItems('institutions-list', 8);
  showRandomItems('residents-list', 8);
});
</script>
{{ end }}
