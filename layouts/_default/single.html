{{ define "main" }}
<article>
  <h1>{{ .Title }}</h1>
  
  <div class="metadata">
    <p><strong>ğŸ“… Date:</strong> <span class="date">{{ .Date.Format "2 January 2006" }}</span></p>
    
    {{ with .Params.dateAdded }}
      <p><strong>ğŸ“Œ Added to archive:</strong> <span class="date">{{ . }}</span></p>
    {{ end }}
    
    {{ with .Params.streets }}
      <p><strong>ğŸ“ Location:</strong> {{ delimit . ", " }}</p>
    {{ end }}
    
    {{ with .Params.themes }}
      <p><strong>ğŸ·ï¸ Themes:</strong> 
        {{ range $index, $theme := . }}
          {{ if $index }}, {{ end }}
          <a href="{{ "/themes/" | relLangURL }}{{ $theme | urlize }}/" style="color: #8b7355; text-decoration: none; border-bottom: 1px solid #8b7355;">{{ $theme }}</a>
        {{ end }}
      </p>
    {{ end }}
  </div>

  <div class="content-section">
    {{ .Content }}
  </div>

  {{ if or .Params.buildings .Params.businesses .Params.institutions .Params.residents }}
  <hr>
  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin: 2rem 0;">
    
    {{ with .Params.buildings }}
    <div class="content-section">
      <h3>ğŸ›ï¸ Buildings</h3>
      <ul>
        {{ range . }}
          {{ with site.GetPage . }}
            <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
          {{ end }}
        {{ end }}
      </ul>
    </div>
    {{ end }}

    {{ with .Params.businesses }}
    <div class="content-section">
      <h3>ğŸª Businesses</h3>
      <ul>
        {{ range . }}
          {{ with site.GetPage . }}
            <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
          {{ end }}
        {{ end }}
      </ul>
    </div>
    {{ end }}

    {{ with .Params.institutions }}
    <div class="content-section">
      <h3>ğŸ¢ Institutions</h3>
      <ul>
        {{ range . }}
          {{ with site.GetPage . }}
            <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
          {{ end }}
        {{ end }}
      </ul>
    </div>
    {{ end }}

    {{ with .Params.residents }}
    <div class="content-section">
      <h3>ğŸ‘¤ Residents</h3>
      <ul>
        {{ range . }}
          {{ with site.GetPage . }}
            <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
          {{ end }}
        {{ end }}
      </ul>
    </div>
    {{ end }}
    
  </div>
  {{ end }}

  {{ with .Params.sources }}
  <hr>
  <div class="content-section">
    <h2>ğŸ“š Sources</h2>
    <ul>
      {{ range . }}
        <li style="background: #f9f7f4; padding: 1rem; margin-bottom: 1rem; border-radius: 4px; list-style: none;">
          {{ if .type }}<strong>Type:</strong> {{ .type }}<br>{{ end }}
          {{ if .title }}<strong>Title:</strong> <em>{{ .title }}</em><br>{{ end }}
          {{ if .issue }}<strong>Issue:</strong> {{ .issue }}<br>{{ end }}
          {{ if .date }}<strong>Date:</strong> {{ .date }}<br>{{ end }}
          {{ if .page }}<strong>Page:</strong> {{ .page }}<br>{{ end }}
          {{ if .url }}<a href="{{ .url }}" target="_blank" style="border-bottom: none;">ğŸ”— View source</a><br>{{ end }}
          {{ if .notes }}<strong>Notes:</strong> {{ .notes }}{{ end }}
        </li>
      {{ end }}
    </ul>
  </div>
  {{ end }}
</article>
{{ end }}